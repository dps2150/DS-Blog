lyrics.df <-  dt_lyrics[dt_lyrics$year>1969,]
years <-  sort(unique(lyrics.df$year))
#get sentiment data for words using tidytext
library(tidytext)
sentiments <-  get_sentiments("afinn")
test.year <-  lyrics.df[lyrics.df$year==1999,]$stemmedwords
typeof(test)
test.year <-  lyrics.df[lyrics.df$year==1999,]$stemmedwords
#typeof(test)
#length(test)
#head(test)
#head(lyrics.df[lyrics.df$year==1990,])
#test <-  test[sample(1:length(test),5000)]
#length(test)
library(ngram)
wordcount(lyrics.df[lyrics.df$year==1990,]$stemmedwords)
test.year <-  lyrics.df[lyrics.df$year==1999,]$stemmedwords
#typeof(test)
#length(test)
#head(test)
#head(lyrics.df[lyrics.df$year==1990,])
#test <-  test[sample(1:length(test),5000)]
#length(test)
#library(ngram)
#wordcount(lyrics.df[lyrics.df$year==1990,]$stemmedwords)
library(tidyverse)
library(wordcloud)
word.freq <- data_frame(text = test.year) %>%
mutate(words = str_split(text, "\\s+")) %>%
unnest(cols=c(words)) %>%
count(words) %>%
filter(!words %in% sentiments$words) %>%
mutate(freq = n / sum(n)) %>%
arrange(desc(n))
word.freq
wordcloud(words=word.freq$words,freq=word.freq$freq,min.freq=1,max.words=100,random.order=F,rot.per=0.35,colors=rainbow(8))
library(tidyverse)
library(wordcloud)
test.year <-  lyrics.df[lyrics.df$year==1999,]$stemmedwords
word.freq <- data_frame(text = test.year) %>%
mutate(words = str_split(text, "\\s+")) %>%
unnest(cols=c(words)) %>%
count(words) %>%
filter(!words %in% sentiments$words) %>%
mutate(freq = n / sum(n)) %>%
arrange(desc(n))
word.freq
wordcloud(words=word.freq$words,freq=word.freq$freq,min.freq=1,max.words=100,random.order=F,rot.per=0.35,colors=rainbow(8))
library(tidyverse)
library(wordcloud)
test.year <-  lyrics.df[lyrics.df$year==1999,]$stemmedwords
word.freq <- data_frame(text = test.year) %>%
mutate(words = str_split(text, "\\s+")) %>%
unnest(cols=c(words)) %>%
count(words) %>%
filter(!words %in% sentiments$words) %>%
mutate(freq = n / sum(n)) %>%
arrange(desc(n))
#word.freq
wordcloud(words=word.freq$words,freq=word.freq$freq,min.freq=1,max.words=100,random.order=F,rot.per=0.35,colors=rainbow(8))
head(sentiments)
library(tidyverse)
library(wordcloud)
test.year <-  lyrics.df[lyrics.df$year==1999,]$stemmedwords
word.freq <- data_frame(text = test.year) %>%
mutate(words = str_split(text, "\\s+")) %>%
unnest(cols=c(words)) %>%
count(words) %>%
filter(!words %in% sentiments$word) %>%
mutate(freq = n / sum(n)) %>%
arrange(desc(n))
#word.freq
wordcloud(words=word.freq$words,freq=word.freq$freq,min.freq=1,max.words=100,random.order=F,rot.per=0.35,colors=rainbow(8))
#assign sentiment value to words
word.freq$value <- 0
year.example <-merge(word.freq,sentiments,by.x="words",by.y="word" )
year.example
#for(word in word.freq$words){
#  if(word %in% sentiments$word){
#    word.freq[word.freq$words == word,]$value <-  sentiments[sentiments$word== word,]$value
#  }
#}
#head(word.freq)
year.example
word.freq
library(tidyverse)
library(wordcloud)
test.year <-  lyrics.df[lyrics.df$year==1999,]$stemmedwords
word.freq <- data_frame(text = test.year) %>%
mutate(words = str_split(text, "\\s+")) %>%
unnest(cols=c(words)) %>%
count(words) %>%
filter(words %in% sentiments$word) %>%
mutate(freq = n / sum(n)) %>%
arrange(desc(n))
#word.freq
wordcloud(words=word.freq$words,freq=word.freq$freq,min.freq=1,max.words=100,random.order=F,rot.per=0.35,colors=rainbow(8))
#assign sentiment value to words
word.freq$value <- 0
year.example <-merge(word.freq,sentiments,by.x="words",by.y="word" )
year.example
#for(word in word.freq$words){
#  if(word %in% sentiments$word){
#    word.freq[word.freq$words == word,]$value <-  sentiments[sentiments$word== word,]$value
#  }
#}
#head(word.freq)
word.freq
library(tidyverse)
library(wordcloud)
test.year <-  lyrics.df[lyrics.df$year==1999,]$stemmedwords
word.freq <- data_frame(text = test.year) %>%
mutate(words = str_split(text, "\\s+")) %>%
unnest(cols=c(words)) %>%
count(words) %>%
#filter(words %in% sentiments$word) %>%
mutate(freq = n / sum(n)) %>%
arrange(desc(n))
#word.freq
wordcloud(words=word.freq$words,freq=word.freq$freq,min.freq=1,max.words=100,random.order=F,rot.per=0.35,colors=rainbow(8))
#assign sentiment value to words
word.freq$value <- 0
year.example <-merge(word.freq,sentiments,by.x="words",by.y="word" )
year.example
#for(word in word.freq$words){
#  if(word %in% sentiments$word){
#    word.freq[word.freq$words == word,]$value <-  sentiments[sentiments$word== word,]$value
#  }
#}
#head(word.freq)
word.freq
#assign sentiment value to words
word.freq$value <- 0
#year.example <-merge(word.freq,sentiments,by.x="words",by.y="word" )
#year.example
for(word in word.freq$words){
if(word %in% sentiments$word){
word.freq[word.freq$words == word,]$value <-  sentiments[sentiments$word== word,]$value
}
}
head(word.freq)
head(word.freq[word.freq$value != 0])
head(word.freq[word.freq$value != 0,])
word.freq$score <- word.freq$n * word..freq$value
word.freq$score <- word.freq$n * word.freq$value
head(word.freq[word.freq$value != 0,])
total.example <- sum(word.freq$score)
total.example <- sum(word.freq$score)
total.example
score <-  rep(0,length(years))
year.sentiment <-  data.frame(years,score)
for(year in years){
#get lyrics of the year
year.lyrics <-  lyrics.df[lyrics.df$year== year,]$stemmedwords
#get sample for years that have more than 5000 songs
if(length(year.lyrics) > 5000){
year.lyrics <- year.lyrics[sample(1:length(year.lyrics),5000)]
}
#find frequency of lyrics
word.freq <- data_frame(text = year.lyrics) %>%
mutate(words = str_split(text, "\\s+")) %>%
unnest(cols=c(words)) %>%
count(words) %>%
mutate(freq = n / sum(n)) %>%
arrange(desc(n))
#assign sentiment value to words
#word.freq$value <- 0
word.freq <-merge(word.freq,sentiments,by.x="words",by.y="word" )
#for(word in word.freq$words){
#  if(word %in% sentiments$word){
#    word.freq[word.freq$words == word,]$value <-  sentiments[sentiments$word== word,]$value
#  }
#}
#vector of year sentiments
year.sentiment[year.sentiment==year,]$score <- sum(word.freq$n * word.freq$value)
}
year.sentiment
ggplot(year.sentiment)
ggplot(year.sentiment,aes(x=year,y=score))
ggplot(year.sentiment,aes(x=year,y=score))+
geom_point() + geom_line() +
facet_grid(Geschlecht ~ Land)
ggplot(year.sentiment,aes(x=year,y=score))+
geom_point() + geom_line()
year.sentiment
ggplot(year.sentiment,aes(x=years,y=score))+
geom_point() + geom_line()
ggplot(year.sentiment,aes(x=years,y=score,color=variable))+
geom_point() + geom_line()
ggplot(year.sentiment,aes(x=years,y=score,color="blue"))+
geom_point() + geom_line()
ggplot(year.sentiment,aes(x=years,y=score,color="sentiment score"))+
geom_point() + geom_line()
require(readxl)
dow.data <-  read_excel("../data/dowjones.xlsx")
dow.data <- as.data.frame(dow.data)
min(years)
max(years)
dow <- dow.data[dow.data$Year > 1970 & dow.data$Year < 2018,]
dow
dow <- dow.data[dow.data$Year %in% year.sentiment$years,]
dow <- arrange(dow,dow$Year)
dow
dow.data$Year
apply(dow,2,as.numeric)
dim(dow)
dim(year.sentiment)
dow.data
dow.sent <- data.frame("years"=years,"sentiment"=year.sentiment$score,"dow"=dow$`Average Closing Price`)
dow.sent
library(ggplot2)
colors <- c("Dow Year Close"="red","Music Sentiment Score"="blue")
ggplot(data=dow.sent, aes(x = years,y= dow,color="Dow Year Close")) +
geom_bar(stat = "identity", fill = "grey")+
geom_bar(data=dow.sent,aes(x=years,y=sentiment,color="Music Sentiment Score"),
stat = "identity", fill = "grey" )+
labs(x="Year",y="Price vs. Score",color="Legend")+
scale_color_manual(values=colors)+
theme(legend.justification=c(.1,.1), legend.position=c(.1,.1))
ds_lm <- lm(log(abs(dow.sent$sentiment))~dow.sent$dow)
plot(dow.sent$dow,log(abs(dow.sent$sentiment)))
abline(ds_lm,col="red")
x <- seq()
plot(dow.sent$dow,ds_lm$residuals)
abline(0,0,col="red")
summary(ds_lm)
dow.sent <- data.frame("years"=years,"sentiment"=year.sentiment$score,"dow"=dow$`Average Closing Price`)
dow.sent
library(ggplot2)
colors <- c("Dow Year Close"="red","Music Sentiment Score"="blue")
ggplot(data=dow.sent, aes(x = years,y= dow,color="Dow Year Close")) +
geom_bar(stat = "identity", fill = "grey")+
geom_bar(data=dow.sent,aes(x=years,y=sentiment,color="Music Sentiment Score"),
stat = "identity", fill = "grey" )+
labs(x="Year",y="Price vs. Score",color="Legend")+
scale_color_manual(values=colors)+
theme(legend.justification=c(.1,.1), legend.position=c(.1,.1))
dow.sent <- data.frame("years"=years,"sentiment"=year.sentiment$score,"dow"=dow$`Year Close`)
dow.sent
library(ggplot2)
colors <- c("Dow Year Close"="red","Music Sentiment Score"="blue")
ggplot(data=dow.sent, aes(x = years,y= dow,color="Dow Year Close")) +
geom_bar(stat = "identity", fill = "grey")+
geom_bar(data=dow.sent,aes(x=years,y=sentiment,color="Music Sentiment Score"),
stat = "identity", fill = "grey" )+
labs(x="Year",y="Price vs. Score",color="Legend")+
scale_color_manual(values=colors)+
theme(legend.justification=c(.1,.1), legend.position=c(.1,.1))
ds_lm <- lm(log(abs(dow.sent$sentiment))~dow.sent$dow)
plot(dow.sent$dow,log(abs(dow.sent$sentiment)))
abline(ds_lm,col="red")
x <- seq()
plot(dow.sent$dow,ds_lm$residuals)
abline(0,0,col="red")
dow.sent <- data.frame("years"=years,"sentiment"=year.sentiment$score,"dow"=dow$`Average Closing Price`)
dow.sent
library(ggplot2)
colors <- c("Dow Year Close"="red","Music Sentiment Score"="blue")
ggplot(data=dow.sent, aes(x = years,y= dow,color="Dow Year Close")) +
geom_bar(stat = "identity", fill = "grey")+
geom_bar(data=dow.sent,aes(x=years,y=sentiment,color="Music Sentiment Score"),
stat = "identity", fill = "grey" )+
labs(x="Year",y="Price vs. Score",color="Legend")+
scale_color_manual(values=colors)+
theme(legend.justification=c(.1,.1), legend.position=c(.1,.1))
ds_lm <- lm(log(abs(dow.sent$sentiment))~dow.sent$dow)
plot(dow.sent$dow,log(abs(dow.sent$sentiment)))
abline(ds_lm,col="red")
x <- seq()
plot(dow.sent$dow,ds_lm$residuals)
abline(0,0,col="red")
summary(ds_lm)
dow <- dow.data[dow.data$Year > 1966 & dow.data$Year < 2015,]
dim(dow2)
dow2 <- dow.data[dow.data$Year > 1966 & dow.data$Year < 2015,]
dim(dow2)
length(years)
dim(dow2)
dow2$Year
dow2 <- dow.data[dow.data$Year > 1966 & dow.data$Year < 2014,]
dim(dow2)
dow.sent <- data.frame("years"=years,"sentiment"=year.sentiment$score,"dow"=dow$`Average Closing Price`)
dow2.sent <- data.frame("years"=years,"sentiment"=year.sentiment$score,"dow"=dow2$`Average Closing Price`)
dow2.sent
dow.sent <- data.frame("years"=years,"sentiment"=year.sentiment$score,"dow"=dow2$`Average Closing Price`)
dow.sent
ds_lm <- lm(log(abs(dow.sent$sentiment))~dow.sent$dow)
plot(dow.sent$dow,log(abs(dow.sent$sentiment)))
abline(ds_lm,col="red")
dow2 <- dow.data[dow.data$Year > 1966 & dow.data$Year < 2014,]
dow.sent <- data.frame("years"=years,"sentiment"=year.sentiment$score,"dow"=dow2$`Average Closing Price`)
dow.sent
ds_lm <- lm(log(abs(dow.sent$sentiment))~dow.sent$dow)
plot(dow.sent$dow,log(abs(dow.sent$sentiment)))
abline(ds_lm,col="red")
summary(ds_lm)
dow2 <- dow.data[dow.data$Year > 1966 & dow.data$Year < 2014,]
dow.sent <- data.frame("years"=years,"sentiment"=year.sentiment$score,"dow"=dow2$`Average Closing Price`)
dow.sent
ds_lm <- lm(dow.sent$sentiment~dow.sent$dow)
plot(dow.sent$dow,dow.sent$sentiment)
abline(ds_lm,col="red")
summary(ds_lm)
dow.sent <- data.frame("years"=years,"sentiment"=year.sentiment$score,"dow"=dow2$`Average Closing Price`)
dow2 <- dow.data[dow.data$Year > 1966 & dow.data$Year < 2014,]
dow.sent <- data.frame("years"=years,"sentiment"=year.sentiment$score,"dow"=dow2$`Average Closing Price`)
dow.sent
ds_lm <- lm(dow.sent$sentiment~dow.sent$dow)
plot(dow.sent$dow,dow.sent$sentiment)
abline(ds_lm,col="red")
summary(ds_lm)
dow2 <- dow.data[dow.data$Year > 1967 & dow.data$Year < 2015,]
dow.sent <- data.frame("years"=years,"sentiment"=year.sentiment$score,"dow"=dow2$`Average Closing Price`)
dow.sent
ds_lm <- lm(dow.sent$sentiment~dow.sent$dow)
plot(dow.sent$dow,dow.sent$sentiment)
abline(ds_lm,col="red")
summary(ds_lm)
dow2 <- dow.data[dow.data$Year > 1965 & dow.data$Year < 2013,]
dow.sent <- data.frame("years"=years,"sentiment"=year.sentiment$score,"dow"=dow2$`Average Closing Price`)
dow.sent
ds_lm <- lm(dow.sent$sentiment~dow.sent$dow)
plot(dow.sent$dow,dow.sent$sentiment)
abline(ds_lm,col="red")
summary(ds_lm)
dow2 <- dow.data[dow.data$Year > 1968 & dow.data$Year < 2016,]
dow2 <- dow.data[dow.data$Year > 1968 & dow.data$Year < 2016,]
dow.sent <- data.frame("years"=years,"sentiment"=year.sentiment$score,"dow"=dow2$`Average Closing Price`)
dow.sent
ds_lm <- lm(dow.sent$sentiment~dow.sent$dow)
plot(dow.sent$dow,dow.sent$sentiment)
abline(ds_lm,col="red")
summary(ds_lm)
dow2
dow2 <- dow.data[dow.data$Year > 1968 & dow.data$Year < 2016,]
dow2 <- arrange(dow2,dow2$Year)
dow2
dow.sent <- data.frame("years"=years,"sentiment"=year.sentiment$score,"dow"=dow2$`Average Closing Price`)
dow.sent
ds_lm <- lm(dow.sent$sentiment~dow.sent$dow)
plot(dow.sent$dow,dow.sent$sentiment)
abline(ds_lm,col="red")
summary(ds_lm)
dow2 <- dow.data[dow.data$Year > 1967 & dow.data$Year < 2015,]
dow2 <- arrange(dow2,dow2$Year)
dow2
dow.sent <- data.frame("years"=years,"sentiment"=year.sentiment$score,"dow"=dow2$`Average Closing Price`)
dow.sent
ds_lm <- lm(dow.sent$sentiment~dow.sent$dow)
plot(dow.sent$dow,dow.sent$sentiment)
abline(ds_lm,col="red")
summary(ds_lm)
dow2 <- dow.data[dow.data$Year > 1966 & dow.data$Year < 2014,]
dow2 <- arrange(dow2,dow2$Year)
dow2
dow.sent <- data.frame("years"=years,"sentiment"=year.sentiment$score,"dow"=dow2$`Average Closing Price`)
dow.sent
ds_lm <- lm(dow.sent$sentiment~dow.sent$dow)
plot(dow.sent$dow,dow.sent$sentiment)
abline(ds_lm,col="red")
summary(ds_lm)
dow2 <- dow.data[dow.data$Year > 1969 & dow.data$Year < 2017,]
dow2 <- arrange(dow2,dow2$Year)
dow2
dow.sent <- data.frame("years"=years,"sentiment"=year.sentiment$score,"dow"=dow2$`Average Closing Price`)
dow.sent
ds_lm <- lm(dow.sent$sentiment~dow.sent$dow)
plot(dow.sent$dow,dow.sent$sentiment)
abline(ds_lm,col="red")
summary(ds_lm)
ds_lm <- lm(log(abs(dow.sent$sentiment))~dow.sent$dow)
plot(dow.sent$dow,log(abs(dow.sent$sentiment)),xlab="Dow Price",ylab="log of Music Sentiment",main="Linear Regression of Music Sentiment on the Dow")
abline(ds_lm,col="red")
ds_lm <- lm(log(abs(dow.sent$sentiment))~dow.sent$dow)
plot(dow.sent$dow,log(abs(dow.sent$sentiment)),xlab="Dow Price",ylab="log of Music Sentiment",main="Linear Regression of Music Sentiment on the Dow")
abline(ds_lm,col="red")
x <- seq()
plot(dow.sent$dow,ds_lm$residuals,xlab="Dow Price",ylab="Residuals of Linear Model",main="Residual Plot of Linear Model")
abline(0,0,col="red")
summary(ds_lm)
dow2 <- dow.data[dow.data$Year > 1969 & dow.data$Year < 2017,]
dow2 <- arrange(dow2,dow2$Year)
dow2
dow.sent <- data.frame("years"=years,"sentiment"=year.sentiment$score,"dow"=dow2$`Average Closing Price`)
dow.sent
ds_lm <- lm(dow.sent$sentiment~dow.sent$dow)
plot(dow.sent$dow,dow.sent$sentiment)
abline(ds_lm,col="red")
summary(ds_lm)
dow2 <- dow.data[dow.data$Year > 1968 & dow.data$Year < 2016,]
dow2 <- arrange(dow2,dow2$Year)
dow2
dow.sent <- data.frame("years"=years,"sentiment"=year.sentiment$score,"dow"=dow2$`Average Closing Price`)
dow.sent
ds_lm <- lm(dow.sent$sentiment~dow.sent$dow)
plot(dow.sent$dow,dow.sent$sentiment)
abline(ds_lm,col="red")
summary(ds_lm)
dow2 <- dow.data[dow.data$Year > 1969 & dow.data$Year < 2017,]
dow2 <- arrange(dow2,dow2$Year)
dow2
dow.sent <- data.frame("years"=years,"sentiment"=year.sentiment$score,"dow"=dow2$`Average Closing Price`)
dow.sent
ds_lm <- lm(dow.sent$sentiment~dow.sent$dow)
plot(dow.sent$dow,dow.sent$sentiment)
abline(ds_lm,col="red")
summary(ds_lm)
knitr::opts_chunk$set(echo = T)
#remove erroneous years
lyrics.df <-  dt_lyrics[dt_lyrics$year>1969,]
years <-  sort(unique(lyrics.df$year))
#get sentiment data for words using tidytext
library(tidytext)
sentiments <-  get_sentiments("afinn")
# load lyrics data
load('../output/processed_lyrics.RData')
knitr::opts_chunk$set(echo = T)
# load lyrics data
load('../output/processed_lyrics.RData')
#remove erroneous years
lyrics.df <-  dt_lyrics[dt_lyrics$year>1969,]
years <-  sort(unique(lyrics.df$year))
#get sentiment data for words using tidytext
library(tidytext)
sentiments <-  get_sentiments("afinn")
library(tidyverse)
library(wordcloud)
test.year <-  lyrics.df[lyrics.df$year==1999,]$stemmedwords
word.freq <- data_frame(text = test.year) %>%
mutate(words = str_split(text, "\\s+")) %>%
unnest(cols=c(words)) %>%
count(words) %>%
#filter(words %in% sentiments$word) %>%
mutate(freq = n / sum(n)) %>%
arrange(desc(n))
#word.freq
wordcloud(words=word.freq$words,freq=word.freq$freq,min.freq=1,max.words=100,random.order=F,rot.per=0.35,colors=rainbow(8))
#assign sentiment value to words
word.freq$value <- 0
#year.example <-merge(word.freq,sentiments,by.x="words",by.y="word" )
#year.example
for(word in word.freq$words){
if(word %in% sentiments$word){
word.freq[word.freq$words == word,]$value <-  sentiments[sentiments$word== word,]$value
}
}
word.freq$score <- word.freq$n * word.freq$value
head(word.freq[word.freq$value != 0,])
total.example <- sum(word.freq$score)
score <-  rep(0,length(years))
year.sentiment <-  data.frame(years,score)
for(year in years){
#get lyrics of the year
year.lyrics <-  lyrics.df[lyrics.df$year== year,]$stemmedwords
#limit sample for years that have more than 5000 songs
if(length(year.lyrics) > 5000){
year.lyrics <- year.lyrics[sample(1:length(year.lyrics),5000)]
}
#find frequency of lyrics
word.freq <- data_frame(text = year.lyrics) %>%
mutate(words = str_split(text, "\\s+")) %>%
unnest(cols=c(words)) %>%
count(words) %>%
mutate(freq = n / sum(n)) %>%
arrange(desc(n))
word.freq <-merge(word.freq,sentiments,by.x="words",by.y="word" )
year.sentiment[year.sentiment==year,]$score <- sum(word.freq$n * word.freq$value)
}
ggplot(year.sentiment,aes(x=years,y=score,color="sentiment score"))+
geom_point() + geom_line()
require(readxl)
dow.data <-  read_excel("../data/dowjones.xlsx")
dow.data <- as.data.frame(dow.data)
#min(years)
#max(years)
#dow <- dow.data[dow.data$Year > 1970 & dow.data$Year < 2018,]
#dow
dow <- dow.data[dow.data$Year %in% year.sentiment$years,]
dow <- arrange(dow,dow$Year)
#dow
#dow.data$Year
#apply(dow,2,as.numeric)
#dim(dow)
#dim(year.sentiment)
#dow.data
dow.sent <- data.frame("years"=years,"sentiment"=year.sentiment$score,"dow"=dow$`Average Closing Price`)
dow.sent
require(readxl)
dow.data <-  read_excel("../data/dowjones.xlsx")
dow.data <- as.data.frame(dow.data)
#min(years)
#max(years)
#dow <- dow.data[dow.data$Year > 1970 & dow.data$Year < 2018,]
#dow
dow <- dow.data[dow.data$Year %in% year.sentiment$years,]
dow <- arrange(dow,dow$Year)
#dow
#dow.data$Year
#apply(dow,2,as.numeric)
#dim(dow)
#dim(year.sentiment)
#dow.data
dow.sent <- data.frame("years"=years,"sentiment"=year.sentiment$score,"dow"=dow$`Average Closing Price`)
library(ggplot2)
colors <- c("Dow Year Close"="red","Music Sentiment Score"="blue")
ggplot(data=dow.sent, aes(x = years,y= dow,color="Dow Year Close")) +
geom_bar(stat = "identity", fill = "grey")+
geom_bar(data=dow.sent,aes(x=years,y=sentiment,color="Music Sentiment Score"),
stat = "identity", fill = "grey" )+
labs(x="Year",y="Price vs. Score",color="Legend")+
scale_color_manual(values=colors)+
theme(legend.justification=c(.1,.1), legend.position=c(.1,.1))
